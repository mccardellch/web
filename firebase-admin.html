<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Firebase Admin</title>
</head>
<body>
<h1>High Scores</h1>
<h1 id="madmaxChanged">null</h1>
<ol id="scoresList"><li>No data yet!</li></ol>

<!-- #1 - link to Firebase goes here  -->
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-analytics.js"></script>
    
<script>
  /* The rest of the Firebase setup code goes here */
  // Your web app's Firebase configuration
  //removed API key for security
/*
  const firebaseConfig = {
      apiKey: "",
      authDomain: "",
      databaseURL: "",
      projectId: "",
      storageBucket: "",
      messagingSenderId: "",
      appId: "",
      measurementId: ""
  };
 */
	
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  //console.log(firebase); // #3 - make sure firebase is loaded
	
  // #4 This is where the magic happens!
  firebase.database().ref("scores2").on("value", dataChanged, firebaseError);

  function dataChanged(data){
      let obj = data.val();
      console.log(obj);
      let bigString = "";
      //use for..in bc it's an object, not array
//      for (let key in obj){ 
//          let row = obj[key];
//          bigString += `<li>${row.userID} : ${row.score}</li>`;
//          console.log(row);
//      }
      
      //use for..of bc Object.keys() returns an array
      for (let key of Object.keys(obj)){
          let row = obj[key];
          bigString += `<li>${row.userID} : ${row.score}</li>`;
          console.log(row);
      }
      scoresList.innerHTML = bigString;
  }
  
  firebase.database().ref("scores2/MADMAX").on("value", madmaxChanged, firebaseError);

    function madmaxChanged(data){
        let obj = data.val();
        let string = "";
        console.log(`madmaxChanged = ${obj}`);
        //console.log(`userName = ${obj.userID}`);
        //console.log(`score= ${obj.score}`);
        string += `${obj.score}`;
        document.querySelector('#madmaxChanged').innerHTML = string;
    }

    function firebaseError(error){
      console.log(error);
    }
	
//    function sortList(ol){
//        let list = [];
//        for(let i = ol.childNodes.length; i--;){
//            if(ol.childNodes[i].nodeName === 'LI')
//                list.push(ol.childNodes[i]);
//        }
//        
//        //sort in descending order
//        list.sort(function(a,b){
//            return parseInt(b.childNodes[0].data, 10) - parseInt(a.childNodes[0].data, 10);
//        })
//        
//        let new_ol = ol.cloneNode(false);
//        
//        //add them into the ul in order
//        for(let i=0; i < list.length; i++){
//            new_ol.appendChild(list[i]);
//        }
//        ol.parentNode.replaceChild(new_ol, ol);
//    }
//    
//    sortList(document.querySelector('#scoresList')[0]);
    
</script>
</body>
</html>
